    

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Potion Punch Clone</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f0f0f0;
        }
        #gameArea {
            position: relative;
            width: 1000px;
            height: 250px;
            margin: 0 auto;          
            overflow: hidden;
        }

        .cozinha {
            background-color: #fff;
            border: 2px solid #333;
        }

        .dispenser {
            width: 80px;
            height: 80px;
            display: inline-block;
            margin: 10px;
            cursor: pointer;
            border: 2px solid #000;
        }
        #redDispenser { background-color: red; }
        #blueDispenser { background-color: blue; }
        #yellowDispenser { background-color: yellow; }

        #bowlArea {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }

        #bowl {
            width: 100px;
            height: 100px;
            background-color: brown;
            border-radius: 50%;
            position: relative;
            cursor: pointer;
        }

        #innerBowl {
            width: 80%;
            height: 80%;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 10%;
            left: 10%;
        }

        #bowlStatus {
            margin-left: 20px;
            font-size: 20px;
            font-weight: bold;
        }

        .client {
            width: 80px;
            height: 80px;
            background-color: pink;
            border: 2px solid #000;
            position: absolute;
            top: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: left 1s ease;           
            /* transition: 1s ease; */           
            cursor: pointer;
            font-size: 12px;
            text-align: center;
            padding: 5px;
        }

        #trash {
            width: 60px;
            height: 60px;
            background-color: gray;
            position: absolute;
            top: 20px;
            right: 20px;
            border: 2px solid black;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        #message {
            margin-top: 20px;
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <h1>Potion Punch Clone</h1>

    <div id="gameArea">


    </div>

        <div class="cozinha">
            <div id="trash">üóëÔ∏è</div>

            <div id="redDispenser" class="dispenser"></div>
            <div id="blueDispenser" class="dispenser"></div>
            <div id="yellowDispenser" class="dispenser"></div>

            <div id="bowlArea">
                <div id="bowl">
                    <div id="innerBowl"></div>
                </div>
                <div id="bowlStatus">Desselecionada</div>
            </div>
        </div>
        

    

    <div id="message"></div>

    <script>

        // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

        const bowl = document.getElementById('bowl');
        const redDispenser = document.getElementById('redDispenser');
        const blueDispenser = document.getElementById('blueDispenser');
        const yellowDispenser = document.getElementById('yellowDispenser');
        const innerBowl = document.getElementById('innerBowl');
        const gameArea = document.getElementById('gameArea');
        const messageBox = document.getElementById('message');
        const trash = document.getElementById('trash');
        const bowlStatus = document.getElementById('bowlStatus');

        let bowlSelected = false;

        // define propriedades do objeto color
        let color = { red: 0, blue: 0, yellow: 0 };

        posicoesUsadas = []
        let clients = [];
        const maxClients = 6;

        // manual
        // const clientPositions = [100, 200, 300, 400, 500, 600];

        // -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


        // verifica se o bowl est√° selecionado, se estiver selecionado, passa o dado falso, e vice-versa
        bowl.addEventListener('click', () => {
            bowlSelected = !bowlSelected;

            // fun√ß√£o que atualiza o estado do bowl
            updateBowlStatus();
        });

        // -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        // fun√ß√£o que atualiza o estado do bowl
        function updateBowlStatus() {
            if (bowlSelected) {
                bowlStatus.textContent = 'Selecionada';
                bowlStatus.style.color = 'green';
            } else {
                bowlStatus.textContent = 'Desselecionada';
                bowlStatus.style.color = 'red';
            }
        }

        // -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        // dispenser de cores

        
        redDispenser.addEventListener('click', () => {
            // verifica se bowl foi selecionado
            if (bowlSelected) {

                // se cor foi usada
                if (color.red === 1) {

                    // mensagem n√£o aparece
                    showMessage("Color already used!");

                    // faz a verifica√ß√£o novamente
                    return;
                }

                // acrescenta 1 
                color.red += 1;
                // ativa a fun√ß√£o
                verifyColor();

            } else {

                // nenhum bowl foi selecionado
                showMessage("No Bowl selected!");
            }
        });

        blueDispenser.addEventListener('click', () => {
            if (bowlSelected) {
                if (color.blue === 1) {
                    showMessage("Color already used!");
                    return;
                }
                color.blue += 1;
                verifyColor();
            } else {
                showMessage("No Bowl selected!");
            }
        });

        yellowDispenser.addEventListener('click', () => {
            if (bowlSelected) {
                if (color.yellow === 1) {
                    showMessage("Color already used!");
                    return;
                }
                color.yellow += 1;
                verifyColor();
            } else {
                showMessage("No Bowl selected!");
            }
        });

        // ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        // lixo

        trash.addEventListener('click', () => {
            resetBowl();
        });


        // ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

        function showMessage(msg) {
            messageBox.textContent = msg;
            setTimeout(() => {
                messageBox.textContent = '';
            }, 2000);
        }


        // ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

        // fun√ß√£o que verifica cor e chama outra fun√ß√£o para definir a cor
        function verifyColor() {
            innerBowl.style.backgroundColor = getCurrentBowlColor();
        }

        // define a cor
        function getCurrentBowlColor() {

            // cada vari√°vel tem valor bool
            const red = color.red > 0;
            const blue = color.blue > 0;
            const yellow = color.yellow > 0;

            // se red, blue e yellow forem true, retorna marrom e coloca esse valor na outta fun√ß√£o
            if (red && blue && yellow) return 'brown';
            if (red && blue) return 'purple';
            if (red && yellow) return 'orange';
            if (blue && yellow) return 'green';
            if (red) return 'red';
            if (blue) return 'blue';
            if (yellow) return 'yellow';

            return 'white';
        }


        // fun√ß√£o para nome e posi√ß√£o random de cada cliente
        function clienteRandom() {
            const personagens = ['Thalita', 'Forg', 'Becllark', 'Alexya', 'Leandro', 'Grigas'];	
            const clientPositions = [100, 200, 300, 400, 500, 600];

            let personagemRandom
            let clientePositionRandom


            do {
            
                //posi√ß√£o pro personagem, gera UM space between diferente multiplicando por um numero aleat√≥rio
                clientePositionRandom = Math.floor(Math.random() * clientPositions.length);

                personagemRandom = Math.floor(Math.random() * personagens.length)
            
            } while (
                clients.some(client => client.textContent === personagens[personagemRandom]) || 
                posicoesUsadas.includes(clientPositions[clientePositionRandom])
            );

            // Adiciona o personagem e a posi√ß√£o √† lista de usados
             posicoesUsadas.push(clientPositions[clientePositionRandom]);

            return {
                nome: personagens[personagemRandom],
                posicao: clientPositions[clientePositionRandom]
            };

            
            
        }


        // -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    
        // fun√ß√£o para criar novo cliente
        // todas as configura√ß√µes para cada clientes est√£o aqui
        function spawnClient() {

            console.log('qutndade de clientes: ', clients.length+1);

            

            // se a quantidade de clientes for igual ou maior q a quantidade m√°xima, retorna, at√© dar falso nessa condi√ß√£o
            if ((clients.length >= maxClients)) return;

            // cria um div do cliente
            const clientDiv = document.createElement('div');
            // coloca a classe do div = client
            clientDiv.classList.add('client');


            const clienteInfo = clienteRandom();

            clientDiv.textContent = clienteInfo.nome;
            clientDiv.style.left = `${clienteInfo.posicao}px`;
            clientDiv.style.top = '100px';


            // cores poss√≠veis
            const possibleColors = ['red', 'blue', 'yellow', 'orange', 'green', 'purple', 'brown'];

            const orderSize = Math.floor(Math.random() * 3) + 1;

            let order = [];
            for (let i = 0; i < orderSize; i++) {
                    const randomColor = possibleColors[Math.floor(Math.random() * possibleColors.length)];
                    order.push(randomColor);
            }

            const textodiv = document.createElement('div');
            textodiv.classList.add('texto');

            
            clientDiv.dataset.order = JSON.stringify(order);
            clientDiv.dataset.progress = "0";
            textodiv.textContent = order.join(', ');

            gameArea.appendChild(clientDiv);
            clientDiv.appendChild(textodiv);
            clientDiv.style.flexDirection = "column";

            const clientIndex = clients.length;

            clientDiv.addEventListener('click', () => {
                handleClientClick(clientDiv);
            });

            // let pedido = pedido++;

            clients.push(clientDiv);

            
           
        }

        function handleClientClick(clientDiv) {
            let order = JSON.parse(clientDiv.dataset.order);
            let progress = parseInt(clientDiv.dataset.progress);

            console.log('Progresso atual: ', progress, 'Pedido: ', order, 'total: '

            );

            let bowlColor = getCurrentBowlColor();

            if (bowlColor === order[progress]) {
                console.log("Bebida certa:", bowlColor);
                progress++;
                clientDiv.dataset.progress = progress.toString();
                resetBowl();

                if (progress >= order.length) {

                    console.log('Pedido completo, removendo cliente:', clientDiv.textContent);

                    clientDiv.style.left = '1000px';
                    setTimeout(() => {
                        

                        // Remove o cliente do DOM e da lista
                        if (gameArea.contains(clientDiv)) {
                            
                            console.log('Removendo cliente:', clientDiv.textContent);
                            gameArea.removeChild(clientDiv);
                        }                       
                        // atualiza a lista de clientes
                        clients = clients.filter(client => client !== clientDiv);

                        // mostra a quantidade de clientes restantes para depura√ß√£o
                        console.log('Clientes restantes:', clients.length);

                        // chama a fun√ß√£o para spawnar um novo cliente ap√≥s um atraso
                        console.log("Cliente atendido: ", clientDiv.textContent);

                        verificarAgir();
                        // spawnClient();
                    }, 1000);
                
                } else {
                    showMessage("Bebida errada!");
                }   
            }
        } 
        
        // verificar se tem espa√ßo, se tiver, novo client, sen√£o, espera abrir espa√ßo
        function verificarAgir() {

            console.log("Verificando espa√ßo para novos clientes...");
            console.log("Clientes ativos:", clients.length, "M√°ximo permitido:", maxClients);

            // if (clients.length < maxClients) {
            //     setInterval(() => { 

            //         console.log("Spawnando novo cliente...");

            //         spawnClient();

            //     }, 1000);

            // } else {
            //     console.log("M√°ximo de clientes atingido.");
            //     // Aqui voc√™ pode implementar uma l√≥gica para esperar que um cliente saia antes de spawnar um novo
            //     while (clients.length === maxClients) {
            //         console.log("Aguardando espa√ßo para novo cliente...");

            //     }
                
            //     return verificarAgir();
            // }

            if (clients.length < maxClients) {
                console.log("Spawnando novo cliente...");
                spawnClient();
            } else {
                console.log("M√°ximo de clientes atingido. Aguardando espa√ßo...");
                setTimeout(verificarAgir, 1000); // Recheca ap√≥s 1 segundo
            }
        }

        function resetBowl() {
            color = { red: 0, blue: 0, yellow: 0 };
            verifyColor();
        }

        for (let i = 0; i < 3; i++) {
            spawnClient();
        }

        

    </script>

</body>

<!-- acrescentar cron√¥metro para os clientes irem embora -->
<!-- cliente ocupando mesmo espa√ßo que o outro -->
<!-- 5 minutos de dia e 5 minutos de noite -->
<!-- dia - atender cliente -->
<!-- noite- fazer outras coisas -->




</html>
